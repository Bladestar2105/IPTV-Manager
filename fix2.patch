--- tests/security/segment_ssrf.test.js
+++ tests/security/segment_ssrf.test.js
@@ -94,7 +94,7 @@
         const res = await request(app)
             .get(`/live/segment/${username}/password/seg.ts`)
-            .query({ token: userToken, data: encrypted });
+            .query({ data: encrypted })
+            .set('Authorization', `Bearer ${userToken}`);

         expect(res.status).toBe(403);
     });
@@ -110,7 +110,7 @@
         const res = await request(app)
             .get(`/live/segment/${username}/password/seg.ts`)
-            .query({ token: userToken, data: encrypted });
+            .query({ data: encrypted })
+            .set('Authorization', `Bearer ${userToken}`);

         expect(res.status).toBe(200);
     });
@@ -127,7 +127,7 @@
         const res = await request(app)
             .get(`/live/segment/${username}/password/seg.ts`)
-            .query({ token: userToken, data: encrypted });
+            .query({ data: encrypted })
+            .set('Authorization', `Bearer ${userToken}`);

         expect(res.status).toBe(200);
     });
